# Rulesets v0.2.0 - Front Matter Schema

This document provides a comprehensive reference for the YAML front matter schema used in Rulesets v0.2.0. The front matter defines rule metadata, provider configuration, and compilation behavior.

## Schema Overview

The front matter uses a structured namespace approach with these top-level keys:

```yaml
---
# Core rule metadata (required)
rule: { ... }

# Standard metadata (optional, passed through to providers)
description: string
name: string
version: string
author: string
tags: string[]

# Provider-specific configuration (optional)
cursor: { ... }
windsurf: { ... }
claude-code: { ... }
agents-md: { ... }
copilot: { ... }

# Legacy support (deprecated, emits warnings)
destinations: { ... }
rulesets: { ... }
---
```

## Core Rule Metadata (`rule` namespace)

The `rule` object contains essential metadata that controls compilation behavior.

### `rule.version` (required)

**Type**: `string`
**Description**: Specifies the Rulesets format version this rule conforms to.
**Current Value**: `'0.2.0'`

```yaml
rule:
  version: '0.2.0'
```

### `rule.template` (optional)

**Type**: `boolean`
**Default**: `false`
**Description**: Enables Handlebars templating for this rule. When `false`, any `{{...}}` expressions in the content will trigger linter warnings.

```yaml
rule:
  template: true   # Enable templating
  template: false  # Disable templating (default)
```

### `rule.globs` (optional)

**Type**: `string[]`
**Description**: File patterns that this rule should apply to. Used by providers that support file-specific rules.

```yaml
rule:
  globs:
    - '**/*.ts'
    - '**/*.tsx'
    - 'src/**/*.js'
```

### Additional `rule` Properties

Any additional properties in the `rule` namespace are preserved and forwarded to providers:

```yaml
rule:
  version: '0.2.0'
  priority: 'high'        # Custom property
  category: 'security'    # Custom property
  experimental: true      # Custom property
```

## Standard Metadata

These top-level keys provide descriptive information about the rule and are passed through to all providers.

### `description`

**Type**: `string`
**Description**: Human-readable description of the rule's purpose.

```yaml
description: 'Security guidelines for authentication and authorization'
description: >-
  Multi-line description that explains
  the purpose and scope of this rule.
```

### `name`

**Type**: `string`
**Default**: Derived from filename
**Description**: Display name for the rule. If omitted, defaults to the filename without extension.

```yaml
name: 'security-guidelines'
```

### `version`

**Type**: `string`
**Description**: Semantic version of the rule content (distinct from `rule.version` which is the format version).

```yaml
version: '1.2.0'  # Rule content version
```

### `author`

**Type**: `string`
**Description**: Author or maintainer of the rule.

```yaml
author: 'Security Team <security@company.com>'
```

### `tags`

**Type**: `string[]`
**Description**: Categorization tags for the rule.

```yaml
tags:
  - security
  - authentication
  - best-practices
```

## Provider Configuration

Each provider has its own namespace in the front matter where you can specify provider-specific settings.

### Common Provider Properties

All providers support these common properties:

#### `enabled`

**Type**: `boolean`
**Default**: `true` (unless overridden by project config)
**Description**: Whether this rule should be compiled for the provider.

```yaml
cursor:
  enabled: true    # Compile for Cursor
windsurf:
  enabled: false   # Skip Windsurf compilation
```

#### `outputPath`

**Type**: `string`
**Description**: Override the default output path for this provider.

```yaml
cursor:
  outputPath: '.cursor/rules/custom/security.mdc'
```

### Provider-Specific Properties

#### Cursor Provider (`cursor`)

```yaml
cursor:
  enabled: true
  priority: 'high' | 'medium' | 'low'     # Rule priority in Cursor
  outputPath: string                       # Custom output path
  handlebars:                             # Handlebars-specific settings
    force: boolean                        # Override safety restrictions
    strict: boolean                       # Strict mode (default: true)
    noEscape: boolean                     # Disable HTML escaping
    partials: Record<string, string>      # Inline partial definitions
```

**Example:**
```yaml
cursor:
  enabled: true
  priority: 'high'
  handlebars:
    force: true
    partials:
      footer: 'Generated by Rulesets v0.2.0'
```

#### Windsurf Provider (`windsurf`)

```yaml
windsurf:
  enabled: true
  format: 'markdown' | 'xml'              # Output format (default: 'markdown')
  outputPath: string                       # Custom output path
  handlebars:                             # Handlebars-specific settings
    force: boolean
    strict: boolean
    noEscape: boolean
    partials: Record<string, string>
```

**Example:**
```yaml
windsurf:
  enabled: true
  format: 'xml'
  outputPath: '.windsurf/rules/security.xml'
```

#### Claude Code Provider (`claude-code`)

```yaml
claude-code:
  enabled: true
  outputPath: string                       # Custom output path (default: 'CLAUDE.md')
  section: string                         # Section name within CLAUDE.md
  handlebars:                             # Handlebars-specific settings
    force: boolean
    strict: boolean
    noEscape: boolean
    partials: Record<string, string>
```

**Example:**
```yaml
claude-code:
  enabled: true
  section: 'security-guidelines'
```

#### AGENTS.md Provider (`agents-md`)

```yaml
agents-md:
  enabled: true
  outputPath: string                       # Custom output path (default: 'AGENTS.md')
  section: string                         # Section name within AGENTS.md
  handlebars:                             # Handlebars-specific settings
    force: boolean
    strict: boolean
    noEscape: boolean
    partials: Record<string, string>
```

#### Copilot Provider (`copilot`)

```yaml
copilot:
  enabled: true
  outputPath: string                       # Custom output path
  handlebars:                             # Handlebars-specific settings
    force: boolean
    strict: boolean
    noEscape: boolean
    partials: Record<string, string>
```

## Handlebars Configuration

When `rule.template: true` is set, additional Handlebars-specific configuration becomes available.

### Global Handlebars Settings

These can be set at the project level in `.ruleset/config.yaml`:

```yaml
rule:
  template: true           # Enable templating by default
  handlebars:
    strict: true           # Strict mode (default)
    noEscape: false        # HTML escape output (default)
```

### Per-Provider Handlebars Settings

Each provider can override Handlebars behavior:

```yaml
cursor:
  handlebars:
    force: true            # Override safety restrictions
    strict: false          # Disable strict mode
    noEscape: true         # Disable HTML escaping
    partials:              # Define inline partials
      footer: 'Custom footer content'
      header: |
        # Custom Header
        Generated on {{date}}
```

### Handlebars Safety Features

- **Strict Mode** (`strict: true`): Undefined variables throw compilation errors
- **HTML Escaping** (`noEscape: false`): Output is HTML-escaped by default
- **Force Override** (`force: false`): Safety features cannot be disabled without explicit `force: true`

## Legacy Support

### Deprecated: `destinations` namespace

**Status**: Deprecated, emits warnings
**Migration**: Use provider-specific namespaces instead

```yaml
# Deprecated (still works but emits warnings)
destinations:
  include: ['cursor', 'windsurf']
  exclude: ['claude-code']

# Preferred
cursor:
  enabled: true
windsurf:
  enabled: true
claude-code:
  enabled: false
```

### Deprecated: `rulesets` namespace

**Status**: Deprecated, emits warnings
**Migration**: Use `rule` namespace instead

```yaml
# Deprecated
rulesets:
  version: '0.2.0'

# Preferred
rule:
  version: '0.2.0'
```

## Validation Rules

The Rulesets linter enforces these validation rules:

### Required Fields
- `rule.version` must be present and valid
- `rule` must be an object, not a string or other type

### Format Validation
- Version strings must follow semantic versioning patterns
- Boolean fields must be `true` or `false`, not strings
- Array fields (like `tags`, `rule.globs`) must be arrays
- Provider configurations must be objects

### Content Validation
- When `rule.template: false`, `{{...}}` expressions trigger warnings
- H1 headings are required in rule content
- Front matter must be valid YAML

## Complete Example

```yaml
---
# Core rule metadata
rule:
  version: '0.2.0'
  template: true
  globs:
    - '**/*.ts'
    - '**/*.tsx'

# Standard metadata
description: 'TypeScript coding standards and best practices'
name: 'typescript-standards'
version: '2.1.0'
author: 'Engineering Team'
tags:
  - typescript
  - coding-standards
  - best-practices

# Provider configuration
cursor:
  enabled: true
  priority: 'high'
  handlebars:
    partials:
      disclaimer: 'These rules are enforced by automated tooling.'

windsurf:
  enabled: true
  format: 'markdown'

claude-code:
  enabled: false

agents-md:
  enabled: true
  section: 'typescript-guidelines'

# Custom provider properties (passed through)
custom-provider:
  enabled: true
  customSetting: 'value'
  nested:
    option: true
---

# TypeScript Standards

{{> disclaimer }}

## Type Safety

- Use strict mode configuration
- Prefer interfaces over type aliases for object shapes
- Always provide return types for public functions

## Code Organization

- Follow the single responsibility principle
- {{#if rule.globs}}
  Apply these rules to: {{#each rule.globs}}`{{this}}`{{#unless @last}}, {{/unless}}{{/each}}
- {{/if}}

{{> disclaimer }}
```

## Schema Evolution

This schema may evolve in future versions. Compatibility guidelines:

- **Additive Changes**: New optional properties may be added
- **Deprecation Process**: Deprecated properties continue to work with warnings
- **Breaking Changes**: Only occur with major version increments
- **Migration Tools**: Automated migration tools will be provided for breaking changes

For the latest schema documentation, always refer to the version matching your Rulesets installation.